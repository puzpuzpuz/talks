<!DOCTYPE html>
<html>
<head>
<title>flamebearer</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
    html, body { height: 100%; }
    body { font: 16px "Helvetica Neue", sans-serif; margin: 0; }
    body.hover { background: #cfc; }
    h1 { font-size: 30px; margin: 30px 30px 15px; }
    h1 a { color: black; text-decoration: none; }
    h1 a:hover { text-decoration: underline; }
    #fire-icon { fill: #f53; width: 26px; height: 26px; vertical-align: -1px; }
    #intro { margin: 0 30px; }
    code { font-size: 13px; color: #444; }
    code span { color: #aaa; }
    #canvas { width: 100%; }
    #controls { display: none; }
    #search { margin-right: 10px; }
    #highlight { position: absolute; pointer-events: none; background: #ffffff40; }
    .loaded #intro { display: none; }
    .loaded #header { display: flex; align-items: center; flex-flow: row wrap; padding: 7px 10px; }
    .loaded h1 { font-size: 22px; margin: 0 auto 0 0; flex-shrink: 0; }
    .loaded #fire-icon { width: 20px; height: 20px; }
    .loaded #controls { display: block; flex-shrink: 0; }
    #tooltip { position: absolute; pointer-events: none; background: #ffffff; white-space: nowrap; box-shadow: 1px 2px 4px 0px rgba(0,0,0,0.3); border-radius: 2px; padding: 3px 5px; font: 12px Tahoma, sans-serif; display: none; }
    #tooltip .path { color: #888; font-size: 11px; }
    #tooltip .time { color: #4a4; }
</style>
</head>
<body>

<div id="header">
    <h1><svg id="fire-icon" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 15 15" style="enable-background:new 0 0 15 15;" xml:space="preserve"><path d="M7.5,0.5L5,4.5l-1.5-2 C2.9452,3.4753,0.8036,5.7924,0.8036,8.3036C0.8036,12.002,3.8017,15,7.5,15s6.6964-2.998,6.6964-6.6964 c0-2.5112-2.1416-4.8283-2.6964-5.8036l-1.5,2L7.5,0.5z M7.5,7c0,0,2.5,2.5618,2.5,4.5c0,0.8371-0.8259,2-2.5,2S5,12.3371,5,11.5 C5,9.6283,7.5,7,7.5,7z"/></svg> <a href="https://github.com/mapbox/flamebearer">flamebearer</a></h1>
    <div id="controls">
        <input id="search" placeholder="Search..." />
        <button id="reset">Reset view</button>
    </div>
</div>
<div id="highlight"></div>
<div id="tooltip"></div>
<div id="intro"><!--  --></div>
<canvas id="canvas" height="0"></canvas>

<!--  -->
<script>'use strict';

const introEl = document.getElementById('intro');
const searchEl = document.getElementById('search');
const highlightEl = document.getElementById('highlight');
const tooltipEl = document.getElementById('tooltip');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let names, levels, numTicks;

names = ["(unknown)","~bootstrapInternalLoaders internal/bootstrap/loaders.js:42:35","~internalBinding internal/bootstrap/loaders.js:100:47","(C++) v8::internal::Runtime_InterpreterDeserializeLazy(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) write","(unknown)","~bootstrapNodeJSCore internal/bootstrap/node.js:15:30","~startup internal/bootstrap/node.js:30:19","~setupProcessFatal internal/bootstrap/node.js:479:29","~NativeModule.require internal/bootstrap/loaders.js:150:34","~NativeModule.compile internal/bootstrap/loaders.js:303:44","~(anonymous) internal/async_hooks.js:1:11","~(anonymous) internal/errors.js:1:11","(C++) v8::internal::Runtime_LoadGlobalIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::ScriptContextTable::Lookup(v8::internal::Handle<v8::internal::ScriptContextTable>, v8::internal::Handle<v8::internal::String>, v8::internal::ScriptContextTable::LookupResult*)","~setupGlobalVariables internal/bootstrap/node.js:345:32","~(anonymous) util.js:1:11","~(anonymous) internal/util/inspect.js:1:11","~(anonymous) internal/util/types.js:1:11","(C++) v8::internal::Runtime_StoreIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::StackFrameIterator::StackFrameIterator(v8::internal::Isolate*)","~(anonymous) buffer.js:1:11","~(anonymous) internal/buffer.js:1:11","(C++) v8::internal::Runtime_KeyedStoreIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::compiler::CommonOperatorBuilder::CommonOperatorBuilder(v8::internal::Zone*)","(C++) v8::internal::MapUpdater::ReconfigureToDataField(int, v8::internal::PropertyAttributes, v8::internal::PropertyConstness, v8::internal::Representation, v8::internal::Handle<v8::internal::FieldType>)","~setupConfig internal/process/per_thread.js:146:21","(C++) v8::internal::Builtin_JsonParse(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::HeapObject::synchronized_set_map(v8::internal::Map*)","~setupRawDebug internal/process/per_thread.js:204:23","(C++) v8::internal::Map::PrepareForDataProperty(v8::internal::Handle<v8::internal::Map>, int, v8::internal::PropertyConstness, v8::internal::Handle<v8::internal::Object>)","~setupGlobalTimeouts internal/bootstrap/node.js:394:31","~(anonymous) timers.js:1:11","~debuglog util.js:181:18","(C++) v8::internal::Runtime_LoadIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) void v8::internal::LookupIterator::Start<false>()","~setupAllowedFlags internal/process/per_thread.js:343:27","(C++) v8::internal::Runtime_CreateObjectLiteral(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Map::CopyAddDescriptor(v8::internal::Handle<v8::internal::Map>, v8::internal::Descriptor*, v8::internal::TransitionFlag)","~Module.runMain internal/modules/cjs/loader.js:741:26","~Module._load internal/modules/cjs/loader.js:503:24","~tryModuleLoad internal/modules/cjs/loader.js:536:23","~Module.load internal/modules/cjs/loader.js:591:33","~Module._nodeModulePaths internal/modules/cjs/loader.js:360:37","~resolve path.js:1068:28","~normalizeString path.js:52:25","(bytecode) ~LdaNamedProperty","~Module._extensions..js internal/modules/cjs/loader.js:710:37","~Module._compile internal/modules/cjs/loader.js:657:37","~(anonymous) ./src/app.js:1:11","~require internal/modules/cjs/helpers.js:19:19","~Module.require internal/modules/cjs/loader.js:631:36","~Module._resolveFilename internal/modules/cjs/loader.js:548:35","~Module._findPath internal/modules/cjs/loader.js:221:28","~tryPackage internal/modules/cjs/loader.js:174:20","~readPackage internal/modules/cjs/loader.js:153:21","(C++) v8::internal::JSObject::MigrateToMap(v8::internal::Handle<v8::internal::JSObject>, v8::internal::Handle<v8::internal::Map>, int)","~(anonymous) ./node_modules/benchmark/benchmark.js:1:11","~(anonymous) ./node_modules/benchmark/benchmark.js:8:11","~runInContext ./node_modules/benchmark/benchmark.js:125:24","~require ./node_modules/benchmark/benchmark.js:647:21","~(anonymous) ./node_modules/lodash/lodash.js:1:11","~(anonymous) ./node_modules/lodash/lodash.js:9:11","~runInContext ./node_modules/lodash/lodash.js:1406:44","(builtin) StringPrototypeReplace","(C++) v8::internal::Runtime_RegExpReplace(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Factory::NewProperSubString(v8::internal::Handle<v8::internal::String>, int, int)","~memoizeCapped ./node_modules/lodash/lodash.js:6430:27","~memoize ./node_modules/lodash/lodash.js:10541:21","~MapCache ./node_modules/lodash/lodash.js:2125:22","(bytecode) ~CallProperty0","(C++) v8::internal::Map::SetPrototype(v8::internal::Handle<v8::internal::Map>, v8::internal::Handle<v8::internal::Object>, bool)","~baseForOwn ./node_modules/lodash/lodash.js:2995:24","~(anonymous) ./node_modules/lodash/lodash.js:4903:22","~(anonymous) ./node_modules/lodash/lodash.js:16976:47","(C++) v8::internal::Factory::NewFixedArrayWithFiller(v8::internal::Heap::RootListIndex, int, v8::internal::Object*, v8::internal::PretenureFlag)","~(anonymous) ./node_modules/microtime/index.js:1:11","~(anonymous) ./node_modules/node-gyp-build/index.js:1:11","~(anonymous) os.js:1:11","(C++) v8::internal::LookupIterator::State v8::internal::LookupIterator::LookupInRegularHolder<false>(v8::internal::Map*, v8::internal::JSReceiver*)","~(anonymous) ./node_modules/platform/platform.js:1:11","~(anonymous) ./node_modules/platform/platform.js:7:11","~parse ./node_modules/platform/platform.js:253:17","~getLayout ./node_modules/platform/platform.js:499:23","~reduce ./node_modules/platform/platform.js:224:18","~each ./node_modules/platform/platform.js:134:16","~(anonymous) ./node_modules/platform/platform.js:226:25","~(anonymous) ./node_modules/platform/platform.js:500:38","(builtin) RegExpPrototypeExec","(C++) v8::internal::Runtime_RegExpExec(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) fwrite","~getProduct ./node_modules/platform/platform.js:566:24","~(anonymous) ./node_modules/platform/platform.js:567:38","(C++) v8::internal::StringHasher::ComputeUtf8Hash(v8::internal::Vector<char const>, unsigned long, int*)","(builtin) RegExpConstructor","(C++) v8::internal::Runtime_RegExpInitializeAndCompile(int, v8::internal::Object**, v8::internal::Isolate*)","(lib) /lib/x86_64-linux-gnu/libc-2.27.so","~getOS ./node_modules/platform/platform.js:547:19","~(anonymous) ./node_modules/platform/platform.js:548:38","(C++) v8::internal::Assembler::pushq(v8::internal::Register)","~getVersion ./node_modules/platform/platform.js:596:24","~(anonymous) ./node_modules/platform/platform.js:597:39","(C++) unibrow::Utf8Iterator::operator*()","~(anonymous) ./node_modules/lodash/lodash.js:6554:22","~apply ./node_modules/lodash/lodash.js:471:17","~(anonymous) ./node_modules/lodash/lodash.js:4841:31","~(anonymous) ./node_modules/lodash/lodash.js:12596:41","~isArrayLike ./node_modules/lodash/lodash.js:11333:25","(builtin) ArrayForEach","~sizes.forEach.size ./src/app.js:58:15","randomString ./src/utils.js:6:22","(builtin) StringAdd_CheckNone_NotTenured","~runSuite ./node_modules/benchmark/benchmark.js:1162:22","~invoke ./node_modules/benchmark/benchmark.js:837:20","~Event ./node_modules/benchmark/benchmark.js:415:19","(C++) v8::internal::(anonymous namespace)::UpdateDescriptorForValue(v8::internal::Handle<v8::internal::Map>, int, v8::internal::PropertyConstness, v8::internal::Handle<v8::internal::Object>)","~_tickCallback internal/process/next_tick.js:41:25","(C++) v8::internal::compiler::LiveRangeBuilder::BuildLiveRanges()","~processTimers timers.js:220:23","~listOnTimeout timers.js:226:23","~tryOnTimeout timers.js:292:22","~ontimeout timers.js:429:19","~(anonymous) ./node_modules/lodash/lodash.js:2756:33","~execute ./node_modules/benchmark/benchmark.js:849:23","~run ./node_modules/benchmark/benchmark.js:2093:17","~compute ./node_modules/benchmark/benchmark.js:1830:21","~enqueue ./node_modules/benchmark/benchmark.js:1843:23","~clone ./node_modules/benchmark/benchmark.js:1367:19","~Benchmark ./node_modules/benchmark/benchmark.js:356:23","~setOptions ./node_modules/benchmark/benchmark.js:692:24","~wrapper ./node_modules/lodash/lodash.js:5158:23","~cloneDeepWith ./node_modules/lodash/lodash.js:11120:27","~baseClone ./node_modules/lodash/lodash.js:2620:23","~arrayEach ./node_modules/lodash/lodash.js:511:21","~(anonymous) ./node_modules/lodash/lodash.js:2691:41","~(anonymous) ./node_modules/lodash/lodash.js:1004:20","(builtin) Call_ReceiverIsAny","~cycle ./node_modules/benchmark/benchmark.js:1984:19","~clock ./node_modules/benchmark/benchmark.js:1563:19","~getRes ./node_modules/benchmark/benchmark.js:1735:22","(C++) v8::internal::Builtin_DateNow(int, v8::internal::Object**, v8::internal::Isolate*)","(lib) [vdso]","(bytecode) ~JumpIfToBooleanTrue","(C++) v8::base::Time::ToJsTime() const","getRes ./node_modules/benchmark/benchmark.js:1735:22","(C++) v8::internal::Runtime_DateCurrentTime(int, v8::internal::Object**, v8::internal::Isolate*)","(builtin) CEntry_Return1_DontSaveFPRegs_ArgvOnStack_NoBuiltinExit","(C++) v8::internal::Factory::NewNumber(double, v8::internal::PretenureFlag)","(C++) v8::internal::Heap::AllocateRawWithRetryOrFail(int, v8::internal::AllocationSpace, v8::internal::AllocationAlignment)","(C++) v8::base::OS::TimeCurrentMillis()","(C++) v8::base::Time::Now()","~clock ./node_modules/benchmark/benchmark.js:1569:23","~createCompiled ./node_modules/benchmark/benchmark.js:1668:30","~interpolate ./node_modules/benchmark/benchmark.js:1784:27","~template ./node_modules/lodash/lodash.js:14771:22","(bytecode) ~TestIn","~(anonymous) :1:20","~suite.add ./src/app.js:65:7","~readUtfCustom ./src/app.js:7:23","~readUInt8 internal/buffer.js:133:19","(builtin) InterpreterEntryTrampoline","~(anonymous) ./node_modules/benchmark/benchmark.js:2061:32","readUtfCustom ./src/app.js:7:23","(C++) v8::internal::Runtime_RegExpExecMultiple(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Zone::New(unsigned long)","~(anonymous) ./node_modules/lodash/lodash.js:15248:36","~(anonymous) ./node_modules/lodash/lodash.js:14865:36","(C++) v8::internal::Builtin_FunctionConstructor(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::CompilationCache::PutEval(v8::internal::Handle<v8::internal::String>, v8::internal::Handle<v8::internal::SharedFunctionInfo>, v8::internal::Handle<v8::internal::Context>, v8::internal::Handle<v8::internal::SharedFunctionInfo>, v8::internal::Handle<v8::internal::FeedbackCell>, int)","(bytecode) ~StaKeyedProperty","~emit ./node_modules/benchmark/benchmark.js:1202:18","~forEach ./node_modules/lodash/lodash.js:9342:21","~(anonymous) ./node_modules/benchmark/benchmark.js:1214:43","~evaluate ./node_modules/benchmark/benchmark.js:1889:24","~getAllKeys ./node_modules/lodash/lodash.js:5857:24","~baseGetAllKeys ./node_modules/lodash/lodash.js:3057:28","~getSymbols ./node_modules/lodash/lodash.js:6017:62","(C++) v8::internal::Builtin_ObjectGetOwnPropertySymbols(int, v8::internal::Object**, v8::internal::Isolate*)","~reset ./node_modules/benchmark/benchmark.js:1444:19","(builtin) KeyedLoadIC_Megamorphic","(C++) v8::internal::JSFunction::GetLength(v8::internal::Isolate*, v8::internal::Handle<v8::internal::JSFunction>)","(C++) v8::internal::String::CalculateLineEnds(v8::internal::Handle<v8::internal::String>, bool)","(C++) v8::internal::CompilationCache::LookupRegExp(v8::internal::Handle<v8::internal::String>, v8::base::Flags<v8::internal::JSRegExp::Flag, int>)","(C++) void v8::internal::String::WriteToFlat<unsigned char>(v8::internal::String*, unsigned char*, int, int)","~initCloneArray ./node_modules/lodash/lodash.js:6154:28","~forOwn ./node_modules/lodash/lodash.js:13014:20","~(anonymous) ./node_modules/lodash/lodash.js:14808:44","(bytecode) ~Return","~stackGet ./node_modules/lodash/lodash.js:2323:22","~listCacheGet ./node_modules/lodash/lodash.js:2066:26","~assocIndexOf ./node_modules/lodash/lodash.js:2487:26","(bytecode) ~StackCheck","~assignValue ./node_modules/lodash/lodash.js:2471:25","~baseAssignValue ./node_modules/lodash/lodash.js:2550:29","(C++) v8::internal::Runtime_SetProperty(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Map::GetConstructor() const","(C++) v8::internal::CompiledReplacement::Compile(v8::internal::Handle<v8::internal::JSRegExp>, v8::internal::Handle<v8::internal::String>, int, int)","(bytecode) ~LdaImmutableContextSlot","(C++) v8::internal::RegExpImpl::Compile(v8::internal::Handle<v8::internal::JSRegExp>, v8::internal::Handle<v8::internal::String>, v8::base::Flags<v8::internal::JSRegExp::Flag, int>)","~(anonymous) ./node_modules/benchmark/benchmark.js:1466:39","(builtin) KeyedLoadIC","~(anonymous) ./node_modules/lodash/lodash.js:12672:47","~keysIn ./node_modules/lodash/lodash.js:13334:20","(builtin) CallFunction_ReceiverIsAny","~copyObject ./node_modules/lodash/lodash.js:4766:24","(bytecode) ~TestEqualStrict","~keys ./node_modules/lodash/lodash.js:13307:18","(builtin) LoadIC_Noninlined","(C++) v8::internal::Runtime_Interrupt(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::StubFrame::GetCallerStackPointer() const","(C++) v8::internal::Factory::NewFeedbackVector(v8::internal::Handle<v8::internal::SharedFunctionInfo>, v8::internal::PretenureFlag)","(C++) v8::internal::Heap::RecordWrite(v8::internal::Object*, v8::internal::Object**, v8::internal::Object*)","(C++) v8::internal::Runtime_AllocateInNewSpace(int, v8::internal::Object**, v8::internal::Isolate*)","(bytecode) ~JumpIfToBooleanFalse","~baseKeysIn ./node_modules/lodash/lodash.js:3508:24","(bytecode) ~ForInEnumerate","(bytecode) ~LdaSmi","(stub) ElementsTransitionAndStoreStub","~toString ./node_modules/lodash/lodash.js:12558:22","(C++) v8::internal::Runtime_NumberToStringSkipCache(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::IntToCString(int, v8::internal::Vector<char>)","(anonymous) ./node_modules/lodash/lodash.js:6554:22","(C++) operator delete(void*)","(C++) v8::internal::Factory::NewFunctionFromSharedFunctionInfo(v8::internal::Handle<v8::internal::SharedFunctionInfo>, v8::internal::Handle<v8::internal::Context>, v8::internal::PretenureFlag)","(bytecode) ~ForInPrepare","(C++) v8::internal::Compiler::GetFunctionFromEval(v8::internal::Handle<v8::internal::String>, v8::internal::Handle<v8::internal::SharedFunctionInfo>, v8::internal::Handle<v8::internal::Context>, v8::internal::LanguageMode, v8::internal::ParseRestriction, int, int, int, int, int, v8::internal::Handle<v8::internal::Object>, v8::ScriptOriginOptions)","(C++) __libc_malloc","(builtin) CEntry_Return1_DontSaveFPRegs_ArgvOnStack_BuiltinExit","~toString native array.js:241:50","~Join native array.js:112:14","(C++) v8::internal::Factory::NewFunction(v8::internal::Handle<v8::internal::Map>, v8::internal::Handle<v8::internal::SharedFunctionInfo>, v8::internal::Handle<v8::internal::Context>, v8::internal::PretenureFlag)","(C++) v8::internal::RegExpKey::IsMatch(v8::internal::Object*)","processTimers timers.js:220:23","(C++) void v8::internal::StringHasher::AddCharacters<unsigned char>(unsigned char const*, int)","(C++) v8::internal::NewSpace::UpdateLinearAllocationArea()","(C++) v8::internal::wasm::WasmCodeManager::LookupCode(unsigned long) const","(bytecode) ~Star","~composeArgs ./node_modules/lodash/lodash.js:4676:25","(bytecode) ~Ldar","(C++) cfree","template ./node_modules/lodash/lodash.js:14771:22","(C++) v8::internal::Runtime_StringBuilderConcat(int, v8::internal::Object**, v8::internal::Isolate*)","~DoJoin native array.js:87:16","~(anonymous) :1:1","(C++) v8::internal::Runtime_NewClosure(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::FeedbackVector::New(v8::internal::Isolate*, v8::internal::Handle<v8::internal::SharedFunctionInfo>)","(C++) v8::internal::Runtime_CompileLazy(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Compiler::Compile(v8::internal::Handle<v8::internal::JSFunction>, v8::internal::Compiler::ClearExceptionFlag)","~escapeStringChar ./node_modules/lodash/lodash.js:1116:28","(bytecode) ~LdaKeyedProperty","(anonymous) ./node_modules/lodash/lodash.js:4841:31","assignValue ./node_modules/lodash/lodash.js:2471:25","(builtin) ObjectPrototypeHasOwnProperty","(C++) v8::internal::LookupIterator::ApplyTransitionToDataProperty(v8::internal::Handle<v8::internal::JSReceiver>)","(C++) v8::internal::RegExpImpl::IrregexpExecRaw(v8::internal::Handle<v8::internal::JSRegExp>, v8::internal::Handle<v8::internal::String>, int, int*, int)","~(anonymous) :4:16","(C++) v8::internal::Runtime_LoadLookupSlot(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::ScopeInfo::VariableIsSynthetic(v8::internal::String*)","(bytecode) ~CreateFunctionContext","~off ./node_modules/benchmark/benchmark.js:1265:17","~(anonymous) ./node_modules/benchmark/benchmark.js:1272:55","~indexOf ./node_modules/lodash/lodash.js:7452:21","~baseIndexOf ./node_modules/lodash/lodash.js:818:23","~strictIndexOf ./node_modules/lodash/lodash.js:1271:25","(builtin) ArgumentsAdaptorTrampoline","~(anonymous) ./node_modules/benchmark/benchmark.js:1375:31","~has ./node_modules/lodash/lodash.js:13159:17","~hasPath ./node_modules/lodash/lodash.js:6125:21","(bytecode) ~LdaImmutableCurrentContextSlot","(C++) v8::internal::StackTraceFrameIterator::IsValidFrame(v8::internal::StackFrame*) const","~isFunction ./node_modules/lodash/lodash.js:11648:24","~baseGetTag ./node_modules/lodash/lodash.js:3069:24","~objectToString ./node_modules/lodash/lodash.js:6539:28","(builtin) ObjectPrototypeToString","baseClone ./node_modules/lodash/lodash.js:2620:23","(builtin) CompileLazy","(builtin) KeyedStoreIC_Megamorphic","(bytecode) ~StaNamedProperty","(builtin) AdaptorWithBuiltinExitFrame","(builtin) StoreIC","~(anonymous) ./node_modules/benchmark/benchmark.js:695:33","(C++) v8::internal::CompilationCacheShape::StringSharedHash(v8::internal::String*, v8::internal::SharedFunctionInfo*, v8::internal::LanguageMode, int)","~baseKeys ./node_modules/lodash/lodash.js:3488:22","~isPrototype ./node_modules/lodash/lodash.js:6384:25","arrayEach ./node_modules/lodash/lodash.js:511:21","(anonymous) ./node_modules/lodash/lodash.js:2691:41","(C++) v8::internal::Factory::AllocateRawWithImmortalMap(int, v8::internal::PretenureFlag, v8::internal::Map*, v8::internal::AllocationAlignment) [clone .constprop.141]","(builtin) CallFunction_ReceiverIsNullOrUndefined","(builtin) KeyedStoreIC","(anonymous) ./node_modules/lodash/lodash.js:12596:41","~initCloneObject ./node_modules/lodash/lodash.js:6173:29","(C++) void v8::internal::LookupIterator::NextInternal<false>(v8::internal::Map*, v8::internal::JSReceiver*)","~castPath ./node_modules/lodash/lodash.js:4461:22","~isKey ./node_modules/lodash/lodash.js:6308:19","(bytecode) ~TestEqual","(lib) /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25","(C++) v8::internal::RegExpImpl::IrregexpPrepare(v8::internal::Handle<v8::internal::JSRegExp>, v8::internal::Handle<v8::internal::String>)","(C++) v8::internal::Builtin_ArraySplice(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Builtin_Impl_ArraySplice(v8::internal::BuiltinArguments, v8::internal::Isolate*)","(builtin) RegExpPrototypeTest","interpolate ./node_modules/benchmark/benchmark.js:1784:27","(C++) v8::internal::Runtime_ToString(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::SaveContext::~SaveContext()","(C++) v8::internal::Factory::NewNoClosuresCell(v8::internal::Handle<v8::internal::HeapObject>)","copyObject ./node_modules/lodash/lodash.js:4766:24","(regexp) <%-([\u0000?)%>|<%=([\u0000?)%>|\u0000^\u0000?:\u0000\u0000)\u0000[\u0000?)%>|$","(C++) v8::internal::IdleScavengeObserver::Step(int, unsigned long, unsigned long)","(C++) v8::internal::Runtime_PushWithContext(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Map::TransitionElementsTo(v8::internal::Handle<v8::internal::Map>, v8::internal::ElementsKind)","(C++) v8::internal::String::SlowEquals(v8::internal::String*)","(C++) v8::internal::NewSpace::EnsureAllocation(int, v8::internal::AllocationAlignment)","(builtin) RegExpReplace","(bytecode) ~CallUndefinedReceiver2","(C++) v8::internal::(anonymous namespace)::CreateDynamicFunction(v8::internal::Isolate*, v8::internal::BuiltinArguments, char const*)","(regexp) ['\n\u000028 \u0000","(C++) v8::internal::SpaceWithLinearArea::ComputeLimit(unsigned long, unsigned long, unsigned long)","(C++) v8::internal::Runtime_StoreLookupSlot_Sloppy(int, v8::internal::Object**, v8::internal::Isolate*)","(builtin) LoadIC_Uninitialized","(C++) v8::internal::Factory::NewFunctionFromSharedFunctionInfo(v8::internal::Handle<v8::internal::Map>, v8::internal::Handle<v8::internal::SharedFunctionInfo>, v8::internal::Handle<v8::internal::Context>, v8::internal::Handle<v8::internal::FeedbackCell>, v8::internal::PretenureFlag)","~isPlainObject ./node_modules/lodash/lodash.js:12037:27","(C++) v8::internal::Runtime_StringEqual(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::HashTable<v8::internal::CompilationCacheTable, v8::internal::CompilationCacheShape>::FindEntry(v8::internal::Isolate*, v8::internal::HashTableKey*)","(bytecode) ~CallProperty2","~delay ./node_modules/benchmark/benchmark.js:535:19","~(anonymous) ./node_modules/lodash/lodash.js:10471:34","~baseDelay ./node_modules/lodash/lodash.js:2752:23","~setTimeout ./node_modules/lodash/lodash.js:6647:47","~setTimeout timers.js:388:20","~exports.active timers.js:151:41","~insert timers.js:167:16","(C++) v8::internal::ParseInfo::~ParseInfo()","~(anonymous) ./node_modules/lodash/lodash.js:1670:22","(builtin) ObjectCreate","(anonymous) ./node_modules/lodash/lodash.js:4903:22","(C++) v8::internal::Runtime_KeyedLoadIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::JSObject::GetElementsAccessor()","~eq ./node_modules/lodash/lodash.js:11185:16","Join native array.js:112:14","~StackPop native array.js:75:18","(C++) v8::internal::Factory::NewStringFromOneByte(v8::internal::Vector<unsigned char const>, v8::internal::PretenureFlag)","(builtin) CallVarargs","(C++) v8::internal::SpaceWithLinearArea::InlineAllocationStep(unsigned long, unsigned long, unsigned long, unsigned long)","(C++) v8::internal::Factory::InitializeJSObjectBody(v8::internal::Handle<v8::internal::JSObject>, v8::internal::Handle<v8::internal::Map>, int)","(regexp) \u0000","(C++) v8::internal::Map::ConnectTransition(v8::internal::Handle<v8::internal::Map>, v8::internal::Handle<v8::internal::Map>, v8::internal::Handle<v8::internal::Name>, v8::internal::SimpleTransitionFlag)","(bytecode) ~JumpLoop","(C++) _init","(C++) v8::internal::ContextSlotCache::Lookup(v8::internal::Object*, v8::internal::String*, v8::internal::VariableMode*, v8::internal::InitializationFlag*, v8::internal::MaybeAssignedFlag*)"];
levels = [[0,1,0,0,1816,5],[0,1,1,0,28,6,0,432,118,0,1356,232],[0,1,2,0,28,7,0,432,119,0,1356,121],[0,1,3,0,1,8,0,3,15,0,1,26,0,1,29,0,1,31,0,1,36,0,20,39,0,432,120,0,1356,122],[0,1,4,0,1,9,0,3,9,0,1,27,0,1,19,0,1,9,0,1,37,0,19,40,0,1,116,0,432,121,0,1329,123,0,27,161],[1,1,10,0,3,10,0,1,28,0,1,30,0,1,10,0,1,38,0,19,41,0,1,23,0,432,122,0,1328,124,0,1,270,0,27,137],[1,1,11,0,3,16,2,1,32,1,19,42,0,1,117,0,368,123,0,64,161,0,1316,137,0,1,170,0,11,178,0,1,271,0,27,151],[1,1,9,0,2,9,0,1,19,2,1,33,1,1,43,0,18,47,1,368,124,0,64,137,0,1301,151,0,15,170,0,1,266,0,6,130,0,3,185,0,2,221,0,1,272,0,5,152,0,22,156],[1,1,10,0,2,10,0,1,25,2,1,34,1,1,44,0,18,48,1,1,125,0,358,137,0,1,170,0,8,178,0,63,151,0,1,170,0,80,152,0,1221,156,0,15,171,0,1,267,0,6,131,0,3,72,0,2,250,0,1,273,0,5,300,0,22,157],[1,1,12,0,1,17,0,1,21,3,1,35,1,1,45,0,18,49,1,1,126,0,1,114,0,31,138,0,320,151,0,6,170,0,1,46,0,1,103,0,3,130,0,4,185,0,2,152,0,61,156,0,1,171,0,32,153,0,4,167,0,1,221,0,2,227,0,1,268,0,1,277,0,1,278,0,1,279,0,37,300,0,2,19,0,2,34,0,2,46,0,1212,157,0,1,160,0,1,317,0,1,334,0,5,133,0,10,284,0,1,292,0,6,274,0,1,73,0,2,333,0,2,106,1,1,64,0,1,111,0,3,240,0,11,111,0,11,162],[1,1,13,0,1,9,0,1,9,5,1,46,0,13,50,0,4,108,0,1,112,1,1,127,0,1,114,0,3,139,0,23,144,0,5,151,0,34,152,0,286,156,0,6,171,1,1,104,0,3,131,0,4,72,0,2,153,0,61,157,0,1,133,0,1,88,0,1,111,0,3,154,0,1,197,0,22,240,0,1,246,0,3,255,0,1,233,0,1,239,0,1,281,0,1,313,0,1,105,0,2,243,4,4,64,0,2,111,0,25,240,0,1,246,0,4,255,0,1,343,0,1,253,0,1,344,0,1,209,0,1,235,2,477,111,0,734,162,0,1,312,2,1,335,0,5,172,0,10,172,0,1,293,0,1,174,0,4,284,0,1,290,0,1,199,0,2,199,0,2,251,1,1,311,1,3,64],[1,1,14,0,1,10,0,1,10,6,1,46,0,12,51,0,4,109,0,1,113,1,1,128,0,1,103,0,2,140,0,1,142,1,22,145,0,2,152,0,3,156,0,33,153,0,1,167,0,1,19,0,285,157,0,6,133,1,1,105,0,3,132,0,3,73,0,1,160,0,2,154,0,26,111,0,35,162,0,1,172,2,2,221,0,1,236,1,7,64,0,1,94,0,1,104,0,8,165,0,2,221,0,1,264,0,1,279,0,1,282,0,1,247,0,2,256,0,1,258,4,1,106,0,2,244,4,1,146,0,2,301,0,1,311,2,6,64,0,2,94,0,1,104,0,9,165,0,1,219,0,6,221,0,1,247,0,1,142,0,1,256,0,1,307,0,1,316,1212,6,212,4,5,5,0,10,5,0,1,299,0,1,175,0,1,134,0,3,285,0,1,203,0,1,46,0,1,142,0,1,336,0,1,252,0,1,276,3,1,65,0,1,96,0,1,186],[2,1,18,0,1,22,7,12,40,0,1,46,0,1,110,0,2,111,0,1,114,1,1,129,0,1,104,0,1,141,0,1,143,2,11,141,0,2,145,0,1,146,0,5,147,0,1,148,0,1,149,0,1,150,0,1,19,0,1,153,0,3,157,0,1,88,0,32,154,0,1,168,0,1,211,0,115,111,0,170,162,0,6,172,1,1,106,0,2,133,0,1,174,0,3,199,1,1,64,0,1,103,61,1,5,2,2,165,2,2,65,0,3,163,0,1,186,0,1,241,0,1,95,0,1,46,0,7,104,0,1,197,0,1,250,0,1,287,2,1,283,1,1,257,0,1,291,5,1,136,0,1,245,0,1,318,4,1,228,0,1,79,0,1,302,3,1,65,0,2,163,0,2,186,0,1,340,0,2,95,0,1,250,0,9,104,0,1,339,1,5,250,2,1,347,0,1,307,0,1,316,1212,1,212,0,1,234,0,1,306,0,1,310,0,1,315,0,1,341,4,4,173,0,1,259,0,8,173,0,1,259,0,1,323,1,1,206,0,1,274,0,1,274,0,1,276,0,1,288,3,1,205,5,1,183,1,1,64],[2,1,19,0,1,23,7,11,41,0,1,52,4,1,114,1,1,130,0,1,105,26,1,35,0,1,154,0,2,111,0,1,158,1,1,46,0,4,64,0,3,94,0,11,103,0,1,155,0,1,218,0,2,219,0,9,221,286,1,212,0,6,5,1,1,192,0,2,134,0,1,175,0,2,179,0,1,200,1,1,163,0,1,169,61,1,173,2,2,104,2,1,239,0,1,296,0,1,75,0,1,254,0,1,286,0,1,64,0,1,241,0,1,146,1,7,166,1,1,201,3,1,142,15,1,337,5,1,148,0,1,305,0,1,308,0,1,64,0,1,322,1,1,309,0,1,321,0,1,201,0,8,166,0,1,278,2,5,201,1227,4,126,0,1,171,0,7,126,0,1,200,0,1,171,0,1,221,1,1,282,0,1,188,0,1,290,13,1,163],[2,1,20,0,1,24,7,11,42,0,1,53,4,1,19,1,1,131,0,1,106,27,1,155,2,1,159,2,2,65,0,2,186,0,3,95,0,9,104,0,1,216,0,1,217,1,1,160,0,1,96,0,1,220,0,2,105,0,7,165,286,1,212,0,6,173,1,1,193,0,1,132,0,1,179,0,1,206,4,1,164,62,1,126,2,2,166,7,1,248,3,5,167,0,1,203,0,1,227,1,1,288,19,1,338,8,1,163,4,1,304,0,8,167,3,1,160,0,1,287,0,3,304,1227,4,127,0,1,133,0,7,127,1,1,284,0,1,324,1,1,252,0,1,189,0,1,331,13,1,314],[11,11,47,0,1,54,4,1,115,1,1,132,0,1,46,30,1,160,2,1,183,0,1,196,0,2,187,0,1,182,0,1,198,0,1,231,0,5,105,0,4,165,6,2,201,0,7,104,287,6,126,1,1,194,0,1,197,1,1,107,67,1,127,2,2,167,7,1,249,3,2,211,0,1,233,0,1,269,0,1,295,1,1,228,21,1,169,8,1,314,4,1,179,0,1,75,0,1,96,0,1,181,0,1,233,0,1,303,0,1,330,0,1,342,0,1,346,6,1,179,0,1,276,1227,2,128,0,1,130,0,1,185,0,1,260,0,5,128,0,1,185,0,1,221,1,1,260,0,1,325,2,1,190,0,1,332],[11,11,48,0,1,55,6,1,133,41,1,5,0,4,201,0,4,104,6,1,160,0,1,202,0,7,166,287,6,127,1,1,195,2,1,207,67,1,128,2,1,211,0,1,233,17,1,229,1279,2,129,0,1,131,0,1,72,0,1,261,0,4,129,0,1,319,0,1,72,0,1,250,1,1,297,0,1,326,2,1,345],[11,11,57,0,1,27,6,1,134,41,1,180,0,2,202,0,2,204,0,4,166,7,1,214,0,6,167,0,1,227,287,5,128,0,1,130,72,1,129,21,1,242,1279,1,130,0,1,185,0,1,274,0,1,73,0,1,262,0,2,130,0,2,185,0,1,320,0,1,73,0,1,289,1,1,298,0,1,327],[11,11,58,0,1,56,6,1,132,42,1,203,0,1,214,0,1,205,0,1,208,0,4,167,7,1,224,0,1,181,0,1,222,0,1,223,0,1,225,0,1,226,0,1,230,0,1,228,287,3,129,0,2,130,0,1,213,72,1,130,21,1,205,1279,1,237,0,1,72,0,1,133,0,1,265,0,1,263,0,2,131,0,2,72,0,1,183,0,1,265,0,1,179,2,1,328],[11,11,59,7,1,133,43,1,215,1,1,209,0,1,168,0,1,181,0,1,183,0,1,210,14,1,229,287,3,130,0,2,131,73,1,131,1301,1,238,0,1,73,0,1,275,0,1,266,0,1,238,0,2,274,0,2,333,1,1,266,3,1,329],[11,10,60,0,1,103,7,1,134,64,1,160,287,3,131,0,2,132,73,1,132,1302,1,280,1,1,267,1,2,284,0,2,280,1,1,267,3,1,136],[11,10,50,0,1,104,7,1,132,352,2,132,0,1,160,0,2,133,73,1,174,1302,1,130,1,1,268,1,1,264,0,1,285,0,2,130,1,1,292],[11,10,51,0,1,105,7,1,135,352,2,133,1,2,134,73,1,175,1302,1,160,4,1,274,0,2,131,1,1,293],[11,10,40,0,1,106,7,1,136,352,2,134,1,2,132,73,1,176,1307,1,284,0,2,274,1,1,294],[11,10,41,0,1,107,360,2,132,1,1,133,0,1,188,73,1,177,1307,1,285,0,1,160,0,1,284],[11,10,42,0,1,46,360,2,133,1,1,134,0,1,189,73,1,177,1307,1,276,1,1,134],[11,10,47,361,2,134,1,1,192,0,1,190,1383,1,274],[11,10,48,361,2,132,1,1,160,0,1,191,1383,1,284],[11,4,61,0,1,76,0,5,80,361,1,133,0,1,184,1386,1,160],[11,4,62,0,1,50,0,5,81,361,1,134,0,1,46],[11,4,63,0,1,51,0,5,82,361,1,192],[11,1,19,0,1,64,0,1,67,0,1,72,0,1,40,0,1,83,0,2,91,0,1,97,0,1,100,361,1,179],[11,1,71,0,1,65,0,1,68,0,1,73,0,1,41,0,1,84,0,2,84,0,1,84,0,1,84],[12,1,66,0,1,69,0,1,74,0,1,42,0,1,85,0,2,85,0,1,85,0,1,85],[13,1,70,0,1,23,0,1,47,0,1,86,0,2,86,0,1,86,0,1,86],[14,1,75,0,1,48,0,1,87,0,2,92,0,1,98,0,1,101],[15,1,77,0,1,88,0,1,88,0,1,94,0,1,88,0,1,88],[15,1,50,0,1,89,0,1,89,0,1,95,0,1,89,0,1,89],[15,1,51,0,1,90,0,1,93,0,1,96,0,1,99,0,1,102],[15,1,40],[15,1,9],[15,1,10],[15,1,78],[15,1,19],[15,1,79]];
numTicks = 1817;

let rangeMin = 0;
let rangeMax = 1;
let topLevel = 0;
let query = '';
let graphWidth, pxPerTick;

const pxPerLevel = 18;
const collapseThreshold = 5;
const hideThreshold = 0.5;
const labelThreshold = 20;

highlightEl.style.height = pxPerLevel + 'px';

if (levels) {
    init();
}

function init() {
    document.body.classList.add('loaded');

    // delta-decode bar positions
    for (const level of levels) {
        let prev = 0;
        for (let i = 0; i < level.length; i += 3) {
            level[i] += prev;
            prev = level[i] + level[i + 1];
        }
    }

    updateFromHash();
    render();
}

window.onhashchange = () => {
    updateFromHash();
    render();
};
canvas.onclick = (e) => {
    const {i, j} = xyToBar(e.offsetX, e.offsetY);
    if (j === -1) return;
    window.location.hash = [i, j].join(',');
    removeHover();
};
document.getElementById('reset').onclick = () => {
    searchEl.value = query = '';
    window.location.hash = '';
    render();
};
window.onresize = render;

searchEl.oninput = (e) => {
    query = e.target.value;
    render();
};

function updateFromHash() {
    const [i, j] = window.location.hash.substr(1).split(',').map(Number);

    if (!isNaN(i) && !isNaN(j)) {
        topLevel = i;
        rangeMin = levels[i][j] / numTicks;
        rangeMax = (levels[i][j] + levels[i][j + 1]) / numTicks;
    } else {
        topLevel = 0;
        rangeMin = 0;
        rangeMax = 1;
    }
}

function tickToX(i) {
    return (i - numTicks * rangeMin) * pxPerTick;
}

function render() {
    if (!levels) return;

    graphWidth = canvas.width = canvas.clientWidth;
    canvas.height = pxPerLevel * (levels.length - topLevel);
    canvas.style.height = canvas.height + 'px';

    if (devicePixelRatio > 1) {
        canvas.width *= 2;
        canvas.height *= 2;
        ctx.scale(2, 2);
    }

    pxPerTick = graphWidth / numTicks / (rangeMax - rangeMin);

    ctx.textBaseline = 'middle';
    ctx.font = '10px Tahoma, sans-serif';
    ctx.strokeStyle = 'white';

    for (let i = 0; i < levels.length - topLevel; i++) {
        const level = levels[topLevel + i];

        for (let j = 0; j < level.length; j += 3) {
            const barIndex = level[j];
            const x = tickToX(barIndex);
            const y = i * pxPerLevel;
            let numBarTicks = level[j + 1];

            const inQuery = query && (names[level[j + 2]].indexOf(query) >= 0) || false;

            // merge very small blocks into big "collapsed" ones for performance
            const collapsed = numBarTicks * pxPerTick <= collapseThreshold;
            if (collapsed) {
                while (
                    j < level.length - 3 &&
                    barIndex + numBarTicks === level[j + 3] &&
                    level[j + 4] * pxPerTick <= collapseThreshold &&
                    (inQuery === (query && (names[level[j + 5]].indexOf(query) >= 0) || false))
                ) {
                    j += 3;
                    numBarTicks += level[j + 1];
                }
            }

            const sw = numBarTicks * pxPerTick - (collapsed ? 0 : 0.5);
            const sh = pxPerLevel - 0.5;

            if (x < -1 || x + sw > graphWidth + 1 || sw < hideThreshold) continue;

            ctx.beginPath();
            ctx.rect(x, y, sw, sh);

            const ratio = numBarTicks / numTicks;

            if (!collapsed) {
                ctx.stroke();
                const intensity = Math.min(1, ratio * Math.pow(1.16, i) / (rangeMax - rangeMin));
                const h = 50 - 50 * intensity;
                const l = 65 + 7 * intensity;
                ctx.fillStyle = inQuery ? 'lightgreen' : `hsl(${h}, 100%, ${l}%)`;
            } else {
                ctx.fillStyle = inQuery ? 'lightgreen' : '#eee';
            }
            ctx.fill();

            if (!collapsed && sw >= labelThreshold) {

                const percent = Math.round(10000 * ratio) / 100;
                const name = `${names[level[j + 2]]} (${percent}%, ${numBarTicks} samples)`;

                ctx.save();
                ctx.clip();
                ctx.fillStyle = 'black';
                ctx.fillText(name, Math.max(x, 0) + 1, y + sh / 2);
                ctx.restore();
            }
        }
    }
}

// pixel coordinates to bar coordinates in the levels array
function xyToBar(x, y) {
    const i = Math.floor(y / pxPerLevel) + topLevel;
    const j = binarySearchLevel(x, levels[i]);
    return {i, j};
}

// binary search of a block in a stack level
function binarySearchLevel(x, level) {
    let i = 0;
    let j = level.length - 3;
    while (i <= j) {
        const m = 3 * ((i / 3 + j / 3) >> 1);
        const x0 = tickToX(level[m]);
        const x1 = tickToX(level[m] + level[m + 1]);
        if (x0 <= x && x1 >= x) {
            return x1 - x0 > collapseThreshold ? m : -1;
        }
        if (x0 > x) {
            j = m - 3;
        } else {
            i = m + 3;
        }
    }
    return -1;
}

if (window.orientation === undefined) {
    canvas.onmousemove = addHover;
    canvas.onmouseout = window.onscroll = removeHover;
}

function removeHover() {
    canvas.style.cursor = '';
    highlightEl.style.display = 'none';
    tooltipEl.style.display = 'none';
}

function addHover(e) {
    const {i, j} = xyToBar(e.offsetX, e.offsetY);

    if (j === -1 || e.offsetX < 0 || e.offsetX > graphWidth) {
        removeHover();
        return;
    }

    canvas.style.cursor = 'pointer';

    const level = levels[i];
    const x = tickToX(level[j]);
    const y = (i - topLevel) * pxPerLevel;
    const sw = tickToX(level[j] + level[j + 1]) - x;

    highlightEl.style.display = 'block';
    highlightEl.style.left = x + 'px';
    highlightEl.style.top = (canvas.offsetTop + y) + 'px';
    highlightEl.style.width = sw + 'px';

    const numBarTicks = level[j + 1];
    const percent = Math.round(10000 * numBarTicks / numTicks) / 100;
    const time = `<span class="time">(${percent}%, ${numBarTicks} samples)</span>`;
    let content = names[level[j + 2]];
    if (content[0] !== '(') content = content.replace(' ', ` ${time}<br><span class="path">`) + '</span>';
    else content += ` ${time}`;

    tooltipEl.innerHTML = content;
    tooltipEl.style.display = 'block';
    tooltipEl.style.left = (Math.min(e.offsetX + 15 + tooltipEl.clientWidth, graphWidth) - tooltipEl.clientWidth) + 'px';
    tooltipEl.style.top = (canvas.offsetTop + e.offsetY + 12) + 'px';
}

// (function frame() { if (levels) render(); requestAnimationFrame(frame); })();


</script>
</body>
</html>
